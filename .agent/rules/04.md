---
trigger: always_on
---

# Clipboard Brain — Project Structure & Naming Rules

## 1. Purpose of This Document

This document defines:

- Exact folder structure.
- File naming conventions.
- Responsibility of each directory.
- Rules for file creation.
- Anti-patterns to avoid.

The AI agent must strictly follow this structure.

---

---

## 2. Root Directory Structure

```

clipboard_brain/
├── docs/
│    ├── 00_PROJECT_OVERVIEW.md
│    ├── 01_PRODUCT_REQUIREMENTS.md
│    ├── 02_ARCHITECTURE.md
│    ├── 03_TECH_STACK.md
│    ├── 04_PROJECT_STRUCTURE.md
│    ├── 05_PLATFORM_CHANNELS.md
│    ├── 06_DATA_MODELS.md
│    ├── 07_AI_INTEGRATION.md
│    ├── 08_STORAGE.md
│    ├── 09_UI_GUIDELINES.md
│    ├── 10_ERROR_HANDLING.md
│    ├── 11_SECURITY_PRIVACY.md
│    └── 12_DEVELOPMENT_WORKFLOW.md
│
├── lib/
├── macos/
├── test/
├── pubspec.yaml
└── README.md

```

---

---

## 3. `lib/` Structure

```

lib/
├── main.dart
│
├── app/
│    ├── app.dart
│    ├── providers.dart
│    └── app_lifecycle.dart
│
├── ui/
│    ├── main_window/
│    │     ├── main_window_page.dart
│    │     ├── main_window_view_model.dart
│    │     └── widgets/
│    │
│    ├── menu_bar/
│    │     ├── menu_bar_page.dart
│    │     └── menu_bar_view_model.dart
│    │
│    ├── settings/
│    │     ├── settings_page.dart
│    │     └── settings_view_model.dart
│    │
│    └── shared/
│          ├── widgets/
│          └── theme/
│
├── domain/
│    ├── entities/
│    ├── services/
│    ├── value_objects/
│
├── infrastructure/
│    ├── clipboard/
│    ├── database/
│    ├── ai/
│    ├── security/
│    └── native_bridge/

```

---

---

## 4. File Naming Conventions

### General Rules

- snake_case for all file names
- No abbreviations
- No generic names like `utils.dart`
- One public class per file

### Examples

✅ `clipboard_item.dart`  
❌ `clipboardItem.dart`  
❌ `ci.dart`

---

---

## 5. UI Layer Rules (`lib/ui`)

- One folder per screen.
- Each screen contains:
  - `*_page.dart` → UI
  - `*_view_model.dart` → state & logic
- Reusable widgets go in `ui/shared/widgets`.

UI files must:

- Contain only rendering logic.
- Not access services or repositories directly.

---

---

## 6. ViewModel Rules

ViewModels must:

- Extend `ChangeNotifier`
- Expose state via getters
- Expose commands via methods
- Never import Flutter widgets
- Never import infrastructure directly

---

---

## 7. Domain Layer Rules (`lib/domain`)

### Entities

- Plain Dart objects
- Immutable where possible
- No framework imports

### Services

- Pure logic only
- Stateless

### Value Objects

- Strongly typed wrappers (e.g. SearchQuery)

---

---

## 8. Infrastructure Layer Rules (`lib/infrastructure`)

- Each concern has its own folder.
- Platform-specific logic isolated.
- Must implement interfaces from Domain or State.

---

---

## 9. Native Code Structure (`macos/`)

```

macos/
├── Runner/
│    ├── AppDelegate.swift
│    ├── MainFlutterWindow.swift
│    └── Plugins/
│          └── ClipboardBrainPlugin.swift

```

- Only Swift allowed.
- All clipboard logic must live here.

---

---

## 10. Test Folder Rules

```

test/
├── domain/
├── view_models/
└── infrastructure/

```

- Test mirrors lib structure.
- No UI tests in MVP unless critical.

---

---

## 11. Documentation Rules

- Every public class must have a doc comment.
- Complex logic must be explained.
- Architecture violations must be documented and justified.

---

---

## 12. Forbidden Patterns

❌ Catch-all folders  
❌ God files  
❌ Duplicate logic  
❌ Logic in `main.dart`  
❌ Platform calls outside native_bridge

---

---

## 13. Change Policy

Structural changes require approval.
